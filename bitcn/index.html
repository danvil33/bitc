<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BITC NETWORK · openai style + full auth</title>
  <!-- Font Awesome 6 -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
  <style>
    /* ----- system font stack – exact same as auth.openai.com ----- */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: #f2f4f6;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      /* OpenAI's exact font stack */
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      padding: 20px;
      font-style: normal;
      font-weight: 400;
      transition: opacity 0.2s;
    }

    /* page system – hidden by default, shown via active class */
    .page {
      display: none;
      width: 100%;
      max-width: 360px;
      flex-direction: column;
      align-items: center;
    }

    .page.active {
      display: flex;
    }

    /* all content blocks stay exactly as original – direct on body via pages */
    .title {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      font-size: 32px;
      font-weight: 400;        /* ✅ NOT bold – regular weight */
      color: #000;
      margin-bottom: 28px;
      line-height: 1.1;
      letter-spacing: -0.5px;
      text-align: center;
      font-style: normal;
      width: 100%;
      max-width: 360px;
    }

    .input-wrapper {
      position: relative;
      margin-bottom: 20px;
      width: 100%;
      max-width: 360px;
    }

    .input-wrapper label {
      display: block;
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      color: #6f6f6f;
      letter-spacing: 0.5px;
      margin-bottom: 6px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      font-style: normal;
    }

    .input-wrapper input {
      width: 100%;
      height: 48px;
      border-radius: 40px;
      border: 1px solid #e8e8e8;
      background: #f9f9f9;
      padding: 0 18px;
      font-size: 15px;
      color: #1f1f1f;
      outline: none;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      font-weight: 400;
    }

    .input-wrapper input:focus {
      border-color: #b0b0b0;
      background: #fff;
    }

    /* Continue button – purple */
    .continue-btn {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      max-width: 360px;
      height: 48px;
      padding: 0 18px;
      background-color: #7c3aed;
      border: none;
      border-radius: 40px;
      font-size: 15px;
      font-weight: 500;
      color: white;
      margin-bottom: 20px;
      cursor: pointer;
      letter-spacing: -0.1px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    }

    .continue-btn span {
      color: white;
      font-weight: 500;
    }

    .continue-btn i {
      color: white;
      font-size: 14px;
      opacity: 0.9;
    }

    /* signup row */
    .signup {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      max-width: 360px;
      margin-bottom: 24px;
      font-size: 15px;
      color: #1e1e1e;
      border-bottom: 1px solid #ececec;
      padding-bottom: 20px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    }

    .signup a {
      color: #10a37f;
      font-weight: 600;
      text-decoration: none;
      cursor: pointer;
    }

    /* OR divider */
    .divider {
      display: flex;
      align-items: center;
      text-align: center;
      color: #8e8e8e;
      font-size: 13px;
      font-weight: 500;
      margin: 4px 0 16px 0;
      width: 100%;
      max-width: 360px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    }

    .divider::before,
    .divider::after {
      content: '';
      flex: 1;
      border-bottom: 1px solid #e0e0e0;
    }

    .divider::before {
      margin-right: 14px;
    }

    .divider::after {
      margin-left: 14px;
    }

    .divider span {
      margin: 0;
      color: #8e8e8e;
    }

    /* SOCIAL BUTTONS – exact OpenAI style */
    .social-btn {
      display: flex;
      align-items: center;
      justify-content: flex-start;
      width: 100%;
      max-width: 360px;
      height: 52px;
      padding: 0 16px;
      background: white;
      border: 1px solid #d0d0d0;
      border-radius: 30px;
      margin-bottom: 12px;
      font-size: 15px;
      font-weight: 500;
      color: #1e1e1e;
      gap: 14px;
      cursor: pointer;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background-color: white;
      letter-spacing: -0.1px;
    }

    .social-btn:hover {
      border-color: #b0b0b0;
      background-color: #fafafa;
    }

    .social-btn i {
      font-size: 22px;
      width: 24px;
      text-align: center;
    }

    .fa-google {
      background: conic-gradient(from -45deg, #4285F4 110deg, #34A853 200deg, #FBBC05 280deg, #EA4335 360deg);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .fa-apple {
      color: #000;
      font-size: 22px;
    }

    .fa-windows {
      background: linear-gradient(45deg, #f25022, #7fba00, #00a4ef, #ffb900);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      font-size: 22px;
    }

    .fa-phone {
      color: #1e1e1e;
      font-size: 22px;
    }

    /* footer */
    .footer {
      display: flex;
      justify-content: center;
      gap: 24px;
      margin-top: 28px;
      font-size: 13px;
      color: #6e6e6e;
      font-weight: 450;
      border-top: 1px solid #f0f0f0;
      padding-top: 22px;
      width: 100%;
      max-width: 360px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    }

    .footer a {
      text-decoration: none;
      color: #6e6e6e;
      font-weight: 460;
      cursor: pointer;
    }

    .footer a:hover {
      color: #1e1e1e;
    }

    /* additional elements needed for full auth flow – kept minimal & inline */
    .back-btn {
      background: none;
      border: none;
      font-size: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
      color: #000;
      margin-bottom: 16px;
      cursor: pointer;
      padding: 8px 0;
      width: 100%;
      font-weight: 500;
    }

    .forgot-link {
      color: #10a37f;
      font-size: 14px;
      font-weight: 500;
      text-decoration: none;
      cursor: pointer;
      text-align: right;
      display: block;
      margin-bottom: 16px;
    }

    .error-message {
      color: #dc2626;
      font-size: 13px;
      margin-top: 6px;
      display: none;
    }

    .info-box {
      background: #f0f7ff;
      padding: 16px;
      border-radius: 16px;
      font-size: 14px;
      color: #1e1e1e;
      margin: 16px 0;
      width: 100%;
      border-left: 4px solid #2563eb;
    }

    .toast {
      position: fixed;
      bottom: 24px;
      left: 50%;
      transform: translateX(-50%);
      padding: 14px 24px;
      border-radius: 40px;
      color: white;
      font-weight: 500;
      z-index: 9999;
      display: flex;
      align-items: center;
      gap: 12px;
      box-shadow: 0 10px 20px rgba(0,0,0,0.1);
      max-width: 90%;
      font-size: 14px;
    }

    .toast.success { background: #10a37f; }
    .toast.error { background: #dc2626; }
    .toast.info { background: #2563eb; }

    .loading {
      display: inline-block;
      width: 18px;
      height: 18px;
      border: 2px solid rgba(255,255,255,0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 0.8s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    .checkbox-group {
      display: flex;
      gap: 12px;
      align-items: flex-start;
      margin: 16px 0;
    }
    .checkbox-input {
      width: 20px;
      height: 20px;
      margin-top: 2px;
    }

    /* force normal style */
    * {
      font-style: normal !important;
    }
  </style>
</head>
<body>
  <!-- ========== PAGE: WELCOME / SIGN IN (original compact ui - ACTIVE BY DEFAULT) ========== -->
  <div class="page active" id="page-welcome">
    <div class="title">Bitc network</div>

    <div class="input-wrapper">
      <label>Email address</label>
      <input type="email" id="welcome-email" placeholder="Enter your email">
    </div>

    <button class="continue-btn" id="welcome-continue">
      <span>Continue</span>
      <i class="fas fa-chevron-right"></i>
    </button>

    <div class="signup">
      <span>Don't have an account?</span>
      <a id="signup-link">Sign up</a>
    </div>

    <div class="divider">
      <span>OR</span>
    </div>

    <button class="social-btn" id="google-btn-welcome">
      <i class="fa-brands fa-google"></i>
      <span>Continue with Google</span>
    </button>
    <button class="social-btn" id="apple-btn-welcome" style="opacity: 0.8; cursor: not-allowed;">
      <i class="fa-brands fa-apple"></i>
      <span>Continue with Apple</span>
    </button>
    <button class="social-btn" id="microsoft-btn-welcome" style="opacity: 0.8; cursor: not-allowed;">
      <i class="fa-brands fa-windows"></i>
      <span>Continue with Microsoft</span>
    </button>
    <button class="social-btn" id="phone-btn-welcome" style="opacity: 0.8; cursor: not-allowed;">
      <i class="fas fa-phone"></i>
      <span>Continue with phone</span>
    </button>

    <div class="footer">
      <a id="terms-link">Terms</a>
      <a id="privacy-link">Privacy</a>
    </div>
  </div>

  <!-- ========== PAGE: LOGIN (full auth) ========== -->
  <div class="page" id="page-login">
    <button class="back-btn" id="login-back"><i class="fas fa-arrow-left"></i> Back</button>
    <div class="title" style="font-size: 28px; margin-bottom: 16px;">Sign in</div>
    
    <div class="input-wrapper">
      <label>Email</label>
      <input type="email" id="login-email" placeholder="your@email.com">
    </div>
    <div class="input-wrapper">
      <label>Password</label>
      <div style="position: relative; width: 100%;">
        <input type="password" id="login-password" placeholder="••••••••">
        <button type="button" style="position: absolute; right: 16px; top: 14px; background: none; border: none; cursor: pointer;" onclick="togglePassword('login-password', this)">
          <i class="fas fa-eye"></i>
        </button>
      </div>
      <div class="error-message" id="login-error"></div>
    </div>

    <a class="forgot-link" id="forgot-password-link">Forgot password?</a>

    <button class="continue-btn" id="login-submit" style="background: #000;">
      <span>Sign in</span>
    </button>

    <div class="signup" style="border-bottom: none; justify-content: center; gap: 8px;">
      <span style="color: #666;">New to Bitc?</span>
      <a id="signup-from-login">Create account</a>
    </div>
  </div>

  <!-- ========== PAGE: REGISTER ========== -->
  <div class="page" id="page-register">
    <button class="back-btn" id="register-back"><i class="fas fa-arrow-left"></i> Back</button>
    <div class="title" style="font-size: 28px; margin-bottom: 8px;">Create account</div>
    
    <div class="input-wrapper">
      <label>Email</label>
      <input type="email" id="register-email" placeholder="your@email.com">
    </div>
    <div class="input-wrapper">
      <label>Password</label>
      <div style="position: relative;">
        <input type="password" id="register-password" placeholder="min. 6 characters">
        <button type="button" style="position: absolute; right: 16px; top: 14px; background: none; border: none;" onclick="togglePassword('register-password', this)">
          <i class="fas fa-eye"></i>
        </button>
      </div>
      <div class="error-message" id="register-pwd-error"></div>
    </div>
    <div class="input-wrapper">
      <label>Confirm password</label>
      <div style="position: relative;">
        <input type="password" id="register-confirm" placeholder="confirm">
        <button type="button" style="position: absolute; right: 16px; top: 14px; background: none; border: none;" onclick="togglePassword('register-confirm', this)">
          <i class="fas fa-eye"></i>
        </button>
      </div>
      <div class="error-message" id="register-confirm-error"></div>
    </div>
    <div class="input-wrapper">
      <label>Referral (optional)</label>
      <input type="text" id="register-referral" placeholder="Enter code">
    </div>

    <div class="checkbox-group">
      <input type="checkbox" id="terms-checkbox" class="checkbox-input">
      <label for="terms-checkbox" style="font-size: 14px; color: #4b5563;">I agree to the Terms and Privacy Policy</label>
    </div>

    <button class="continue-btn" id="register-submit" style="background: #000; margin-top: 8px;">
      <span>Create account</span>
    </button>

    <div class="signup" style="border-bottom: none; justify-content: center; gap: 8px; margin-top: 16px;">
      <span style="color: #666;">Already have an account?</span>
      <a id="signin-from-register">Sign in</a>
    </div>
  </div>

  <!-- ========== PAGE: FORGOT PASSWORD ========== -->
  <div class="page" id="page-forgot">
    <button class="back-btn" id="forgot-back"><i class="fas fa-arrow-left"></i> Back</button>
    <div class="title" style="font-size: 28px; margin-bottom: 16px;">Reset password</div>
    
    <div class="info-box">
      <i class="fas fa-info-circle"></i> We'll send you a reset link via email.
    </div>

    <div class="input-wrapper">
      <label>Email</label>
      <input type="email" id="forgot-email" placeholder="your@email.com">
    </div>
    
    <button class="continue-btn" id="forgot-submit" style="background: #000;">
      <span>Send reset link</span>
    </button>
  </div>

  <!-- ========== PAGE: VERIFY EMAIL ========== -->
  <div class="page" id="page-verify">
    <button class="back-btn" id="verify-back"><i class="fas fa-arrow-left"></i> Back</button>
    <div style="text-align: center; margin: 20px 0;">
      <i class="fas fa-envelope-circle-check" style="font-size: 64px; color: #2563eb;"></i>
    </div>
    <div class="title" style="font-size: 26px; margin-bottom: 8px;">Verify your email</div>
    <p style="color: #4b5563; text-align: center; margin-bottom: 20px;" id="verify-message">Verification sent to your inbox</p>
    
    <div class="info-box">
      <i class="fas fa-info-circle"></i> Please check your email and click the verification link. If not received, check spam.
    </div>
    
    <button class="continue-btn" id="resend-verify-btn" style="background: #7c3aed; margin-bottom: 12px;">
      <span>Resend email</span>
    </button>
    <button class="social-btn" id="verify-login-btn" style="justify-content: center;">
      <span>Continue to sign in</span>
    </button>
  </div>

  <!-- Firebase SDK (module) -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
    import { 
      getAuth, 
      signInWithEmailAndPassword, 
      createUserWithEmailAndPassword, 
      sendPasswordResetEmail, 
      sendEmailVerification,
      signInWithPopup,
      GoogleAuthProvider
    } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
    import { 
      getFirestore, 
      doc, 
      setDoc, 
      getDoc 
    } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBEjeRSyKbpEmbNk0SYLUFPp3lbgP9x3Ow",
      authDomain: "volcanobxpl.firebaseapp.com",
      projectId: "volcanobxpl",
      storageBucket: "volcanobxpl.firebasestorage.app",
      messagingSenderId: "742861205377",
      appId: "1:742861205377:web:bbe8a42b78c90354a64280",
      measurementId: "G-G1KWGHLZES"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);
    const googleProvider = new GoogleAuthProvider();

    window.firebaseAuth = auth;
    window.firebaseDb = db;
    window.firebase = {
      signInWithEmailAndPassword,
      createUserWithEmailAndPassword,
      sendPasswordResetEmail,
      sendEmailVerification,
      signInWithPopup,
      setDoc,
      doc,
      getDoc,
      googleProvider
    };
  </script>

  <script>
    // ---------- GLOBAL UI & AUTH ----------
    let currentUser = null;
    let pendingEmail = '';

    const pages = {
      welcome: document.getElementById('page-welcome'),
      login: document.getElementById('page-login'),
      register: document.getElementById('page-register'),
      forgot: document.getElementById('page-forgot'),
      verify: document.getElementById('page-verify')
    };

    // ---------- TOAST ----------
    function showToast(msg, type = 'success') {
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      toast.innerHTML = `<i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'}"></i> ${msg}`;
      document.body.appendChild(toast);
      setTimeout(() => { toast.remove(); }, 3000);
    }

    // ---------- NAVIGATION ----------
    window.navigateTo = function(pageId) {
      Object.values(pages).forEach(p => p.classList.remove('active'));
      document.getElementById(`page-${pageId}`).classList.add('active');
    };

    // ---------- TOGGLE PASSWORD ----------
    window.togglePassword = function(inputId, btn) {
      const input = document.getElementById(inputId);
      const icon = btn.querySelector('i');
      if (input.type === 'password') {
        input.type = 'text';
        icon.classList.replace('fa-eye', 'fa-eye-slash');
      } else {
        input.type = 'password';
        icon.classList.replace('fa-eye-slash', 'fa-eye');
      }
    };

    // ---------- CREATE USER PROFILE ----------
    async function createUserProfile(user, referral = null) {
      try {
        const profile = {
          email: user.email,
          createdAt: new Date().toISOString(),
          emailVerified: user.emailVerified,
          miningData: {
            referralCode: user.uid.substring(0, 8).toUpperCase(),
            usedReferralCode: referral || null,
            createdAt: new Date().toISOString()
          }
        };
        await window.firebase.setDoc(window.firebase.doc(window.firebaseDb, "users", user.uid), profile);
      } catch (e) { console.warn('Profile creation skipped'); }
    }

    // ---------- EVENT LISTENERS ----------
    document.addEventListener('DOMContentLoaded', () => {
      // ---- WELCOME PAGE ----
      document.getElementById('welcome-continue').addEventListener('click', () => {
        const email = document.getElementById('welcome-email').value;
        if (email) { pendingEmail = email; }
        navigateTo('login');
        if (email) document.getElementById('login-email').value = email;
      });
      document.getElementById('signup-link').addEventListener('click', () => navigateTo('register'));
      document.getElementById('google-btn-welcome').addEventListener('click', handleGoogleSignIn);

      // ---- LOGIN PAGE ----
      document.getElementById('login-back').addEventListener('click', () => navigateTo('welcome'));
      document.getElementById('forgot-password-link').addEventListener('click', () => navigateTo('forgot'));
      document.getElementById('signup-from-login').addEventListener('click', () => navigateTo('register'));
      document.getElementById('login-submit').addEventListener('click', handleEmailLogin);

      // ---- REGISTER PAGE ----
      document.getElementById('register-back').addEventListener('click', () => navigateTo('welcome'));
      document.getElementById('signin-from-register').addEventListener('click', () => navigateTo('login'));
      document.getElementById('register-submit').addEventListener('click', handleEmailSignup);

      // ---- FORGOT PAGE ----
      document.getElementById('forgot-back').addEventListener('click', () => navigateTo('login'));
      document.getElementById('forgot-submit').addEventListener('click', handleForgotPassword);

      // ---- VERIFY PAGE ----
      document.getElementById('verify-back').addEventListener('click', () => navigateTo('login'));
      document.getElementById('resend-verify-btn').addEventListener('click', resendVerification);
      document.getElementById('verify-login-btn').addEventListener('click', () => navigateTo('login'));

      // ---- TERMS & FOOTER ----
      document.getElementById('terms-link')?.addEventListener('click', () => showToast('Terms of Service - coming soon', 'info'));
      document.getElementById('privacy-link')?.addEventListener('click', () => showToast('Privacy Policy - coming soon', 'info'));
    });

    // ---------- AUTH HANDLERS ----------
    async function handleEmailLogin() {
      const email = document.getElementById('login-email').value;
      const pwd = document.getElementById('login-password').value;
      const btn = document.getElementById('login-submit');
      const errEl = document.getElementById('login-error');

      if (!email || !pwd) return showToast('Please fill in all fields', 'error');
      
      btn.innerHTML = '<div class="loading"></div> Signing in...'; 
      btn.disabled = true;
      errEl.style.display = 'none';

      try {
        const cred = await window.firebase.signInWithEmailAndPassword(window.firebaseAuth, email, pwd);
        const user = cred.user;
        if (!user.emailVerified) {
          currentUser = user;
          document.getElementById('verify-message').innerText = `Verification sent to ${user.email}`;
          navigateTo('verify');
          showToast('Please verify your email', 'error');
          return;
        }
        showToast('Login successful! Redirecting...', 'success');
        setTimeout(() => window.location.href = 'mining.html', 1500);
      } catch (err) {
        let msg = 'Login failed';
        if (err.code === 'auth/user-not-found') msg = 'No account found';
        else if (err.code === 'auth/wrong-password') msg = 'Incorrect password';
        else if (err.code === 'auth/invalid-email') msg = 'Invalid email';
        errEl.innerText = msg; errEl.style.display = 'block';
        showToast(msg, 'error');
      } finally {
        btn.innerHTML = '<span>Sign in</span>';
        btn.disabled = false;
      }
    }

    async function handleEmailSignup() {
      const email = document.getElementById('register-email').value;
      const pwd = document.getElementById('register-password').value;
      const confirm = document.getElementById('register-confirm').value;
      const referral = document.getElementById('register-referral').value;
      const terms = document.getElementById('terms-checkbox').checked;

      if (!terms) return showToast('Please agree to Terms & Privacy', 'error');
      if (pwd !== confirm) {
        document.getElementById('register-confirm-error').innerText = 'Passwords do not match';
        document.getElementById('register-confirm-error').style.display = 'block';
        return;
      }
      if (pwd.length < 6) {
        document.getElementById('register-pwd-error').innerText = 'Password must be at least 6 characters';
        document.getElementById('register-pwd-error').style.display = 'block';
        return;
      }

      const btn = document.getElementById('register-submit');
      btn.innerHTML = '<div class="loading"></div> Creating...'; btn.disabled = true;

      try {
        const cred = await window.firebase.createUserWithEmailAndPassword(window.firebaseAuth, email, pwd);
        const user = cred.user;
        await window.firebase.sendEmailVerification(user);
        await createUserProfile(user, referral);
        currentUser = user;
        document.getElementById('verify-message').innerText = `Verification sent to ${user.email}`;
        navigateTo('verify');
        showToast('Account created! Check your email.', 'success');
      } catch (err) {
        let msg = 'Signup failed';
        if (err.code === 'auth/email-already-in-use') msg = 'Email already in use';
        else if (err.code === 'auth/weak-password') msg = 'Password too weak';
        else if (err.code === 'auth/invalid-email') msg = 'Invalid email';
        showToast(msg, 'error');
      } finally {
        btn.innerHTML = '<span>Create account</span>';
        btn.disabled = false;
      }
    }

    async function handleGoogleSignIn() {
      const btn = document.getElementById('google-btn-welcome');
      const orig = btn.innerHTML;
      btn.innerHTML = '<div class="loading"></div> Connecting...'; btn.disabled = true;
      try {
        const result = await window.firebase.signInWithPopup(window.firebaseAuth, window.firebase.googleProvider);
        const user = result.user;
        const userDoc = await window.firebase.getDoc(window.firebase.doc(window.firebaseDb, "users", user.uid));
        if (!userDoc.exists()) await createUserProfile(user);
        showToast('Google sign-in successful!', 'success');
        setTimeout(() => window.location.href = 'mining.html', 1500);
      } catch (err) {
        showToast('Google sign-in failed', 'error');
        btn.innerHTML = orig; btn.disabled = false;
      }
    }

    async function handleForgotPassword() {
      const email = document.getElementById('forgot-email').value;
      if (!email) return showToast('Enter your email', 'error');
      const btn = document.getElementById('forgot-submit');
      btn.innerHTML = '<div class="loading"></div> Sending...'; btn.disabled = true;
      try {
        await window.firebase.sendPasswordResetEmail(window.firebaseAuth, email);
        showToast('Reset link sent!', 'success');
        setTimeout(() => navigateTo('login'), 2000);
      } catch (err) {
        let msg = 'Failed to send';
        if (err.code === 'auth/user-not-found') msg = 'Email not found';
        showToast(msg, 'error');
      } finally { btn.innerHTML = '<span>Send reset link</span>'; btn.disabled = false; }
    }

    async function resendVerification() {
      if (!currentUser) return showToast('Please sign in first', 'error');
      const btn = document.getElementById('resend-verify-btn');
      btn.innerHTML = '<div class="loading"></div> Sending...'; btn.disabled = true;
      try {
        await window.firebase.sendEmailVerification(currentUser);
        showToast('Verification email resent!', 'success');
      } catch (err) { showToast('Failed to resend', 'error'); }
      finally { btn.innerHTML = '<span>Resend email</span>'; btn.disabled = false; }
    }

    // NO AUTH STATE CHECKING - completely removed
    // No onAuthStateChanged, no loading page, no redirects
    
    // Make sure welcome page is active (already has active class)
    // And disable any auto redirects
    
    // Small fix: ensure welcome page is the only active one
    window.navigateTo('welcome');
  </script>
</body>
</html>
