<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sign in ¬∑ Bitc network</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    /* global white background ‚Äì clean, rectangular, purple buttons */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      background: #ffffff;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      padding: 20px;
    }

    .container {
      width: 320px;
    }

    /* each view directly on white ‚Äì no cards, no shadows */
    .auth-panel {
      display: block;
      background: transparent;
      padding: 0;
      border: none;
    }

    h1 {
      font-size: 24px;
      font-weight: 600;
      text-align: center;
      margin-bottom: 8px;
      color: #202124;
    }

    .subtitle {
      text-align: center;
      font-size: 14px;
      color: #5f6368;
      margin-bottom: 32px;
      font-weight: 400;
    }

    /* social buttons ‚Äì rectangular, consistent size */
    .social-btn {
      width: 100%;
      height: 52px;
      border: 1px solid #dadce0;
      background: #ffffff;
      font-size: 15px;
      font-weight: 500;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      margin-bottom: 12px;
      cursor: pointer;
      transition: background 0.15s ease;
      border-radius: 0;
    }

    .social-btn:hover:not(:disabled) {
      background: #f5f5f5;
    }

    .social-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .social-btn img {
      width: 20px;
      height: 20px;
      object-fit: contain;
    }

    .divider {
      display: flex;
      align-items: center;
      margin: 28px 0;
      color: #9aa0a6;
      font-size: 12px;
    }

    .divider::before,
    .divider::after {
      content: "";
      flex: 1;
      height: 1px;
      background: #e8eaed;
    }

    .divider span {
      margin: 0 12px;
    }

    /* form fields ‚Äì rectangular, consistent height */
    .form-group {
      position: relative;
      margin-bottom: 20px;
    }

    .form-group input {
      width: 100%;
      height: 52px;
      border: 2px solid #dadce0;
      background: #ffffff;
      padding: 16px 14px 6px 14px;
      font-size: 15px;
      outline: none;
      transition: border 0.15s ease;
      border-radius: 0;
      font-family: 'Inter', sans-serif;
    }

    .form-group input:focus {
      border-color: #7b2eda;
    }

    .form-group input.error {
      border-color: #dc2626;
    }

    .form-group label {
      position: absolute;
      top: 8px;
      left: 14px;
      font-size: 11px;
      color: #5f6368;
      background: #ffffff;
      padding: 0 4px;
      pointer-events: none;
      font-weight: 500;
      letter-spacing: 0.2px;
      text-transform: uppercase;
    }

    .password-wrapper {
      position: relative;
    }

    .password-wrapper input {
      padding-right: 48px;
    }

    .eye-icon {
      position: absolute;
      right: 16px;
      top: 50%;
      transform: translateY(-50%);
      cursor: pointer;
      width: 20px;
      height: 20px;
      opacity: 0.6;
      color: #5f6368;
    }

    .checkbox-group {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 14px;
      color: #3c4043;
      margin: 12px 0 28px 0;
    }

    .checkbox-group input {
      width: 18px;
      height: 18px;
      accent-color: #7b2eda;
      border-radius: 0;
    }

    /* primary button ‚Äì purple, rectangular, same height */
    .continue-btn {
      width: 100%;
      height: 52px;
      border: none;
      background: #7b2eda;
      color: #ffffff;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.15s ease;
      border-radius: 0;
      font-family: 'Inter', sans-serif;
    }

    .continue-btn:hover:not(:disabled) {
      background: #6323b5;
    }

    .continue-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .bottom-text {
      text-align: center;
      font-size: 14px;
      color: #5f6368;
      margin-top: 28px;
      line-height: 1.6;
    }

    .bottom-text a {
      color: #7b2eda;
      font-weight: 500;
      text-decoration: underline;
      cursor: pointer;
    }

    .bottom-text a:hover {
      color: #6323b5;
    }

    .back-link {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 14px;
      font-weight: 500;
      margin-bottom: 24px;
      cursor: pointer;
      color: #7b2eda;
      text-decoration: none;
    }

    .back-link:hover {
      text-decoration: underline;
      color: #6323b5;
    }

    .forgot-note {
      font-size: 14px;
      margin: -8px 0 28px 0;
      text-align: right;
    }

    .forgot-note a {
      color: #7b2eda;
      font-weight: 500;
      text-decoration: none;
      cursor: pointer;
    }

    .forgot-note a:hover {
      text-decoration: underline;
    }

    .forgot-instruction {
      background: #f4ecfb;
      border-left: 6px solid #7b2eda;
      padding: 18px 20px;
      margin-bottom: 28px;
      font-size: 14px;
      color: #202124;
      line-height: 1.5;
      border-radius: 0;
    }

    .forgot-instruction strong {
      color: #7b2eda;
    }

    .reset-message {
      background: #f0e6ff;
      padding: 24px 20px;
      margin: 24px 0 16px;
      text-align: center;
      border: 1px solid #d0b2ff;
      border-radius: 0;
    }

    .reset-message .check-icon {
      background: #7b2eda;
      color: white;
      width: 44px;
      height: 44px;
      border-radius: 0;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 16px;
      font-size: 24px;
      font-weight: 600;
    }

    .reset-message p {
      font-size: 15px;
      color: #202124;
      margin-bottom: 10px;
    }

    .reset-message .small-note {
      font-size: 14px;
      color: #5f6368;
    }

    .email-placeholder {
      font-weight: 600;
      color: #7b2eda;
      background: #ffffff;
      padding: 2px 10px;
      border: 1px solid #d0b2ff;
      display: inline-block;
      margin: 6px 0;
    }

    .hidden {
      display: none !important;
    }

    hr {
      border: none;
      border-top: 1px solid #e8eaed;
      margin: 28px 0 20px;
    }

    .field-hint {
      font-size: 13px;
      color: #5f6368;
      margin: 4px 0 0 2px;
    }

    .action-links {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 24px;
      font-size: 14px;
    }

    .action-links a {
      color: #7b2eda;
      text-decoration: underline;
      font-weight: 500;
    }

    .action-links a:hover {
      color: #6323b5;
    }

    .error-message {
      color: #dc2626;
      font-size: 13px;
      margin-top: 4px;
      display: none;
    }

    .error-message.visible {
      display: block;
    }

    .toast {
      position: fixed;
      bottom: 24px;
      left: 50%;
      transform: translateX(-50%);
      padding: 14px 24px;
      background: #10a37f;
      color: white;
      font-weight: 500;
      z-index: 9999;
      display: flex;
      align-items: center;
      gap: 12px;
      box-shadow: 0 10px 20px rgba(0,0,0,0.1);
      max-width: 90%;
      font-size: 14px;
      border-radius: 0;
    }

    .toast.error {
      background: #dc2626;
    }

    .toast.info {
      background: #2563eb;
    }

    .loading {
      display: inline-block;
      width: 18px;
      height: 18px;
      border: 2px solid rgba(255,255,255,0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 0.8s linear infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
<div class="container">
  <!-- SIGNUP view -->
  <div id="signupView" class="auth-panel">
    <h1>Create your account</h1>
    <p class="subtitle">Join Bitc network today</p>

    <button class="social-btn" id="googleBtn"><img src="https://upload.wikimedia.org/wikipedia/commons/0/09/IOS_Google_icon.png" alt=""> Continue with Google</button>

    <div class="divider"><span>OR</span></div>

    <div class="form-group">
      <label>Email</label>
      <input type="email" id="signupEmail" placeholder=" ">
      <div class="error-message" id="signupEmailError"></div>
    </div>

    <div class="form-group password-wrapper">
      <label>Password</label>
      <input type="password" id="signupPassword">
      <svg class="eye-icon" onclick="togglePassword('signupPassword')" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0zm7.5 0S18 5 12 5 4.5 12 4.5 12 6 19 12 19s7.5-7 7.5-7z"/>
      </svg>
      <div class="error-message" id="signupPasswordError"></div>
    </div>

    <div class="form-group password-wrapper">
      <label>Confirm password</label>
      <input type="password" id="signupConfirmPassword">
      <svg class="eye-icon" onclick="togglePassword('signupConfirmPassword')" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0zm7.5 0S18 5 12 5 4.5 12 4.5 12 6 19 12 19s7.5-7 7.5-7z"/>
      </svg>
      <div class="error-message" id="signupConfirmError"></div>
    </div>

    <div class="form-group">
      <label>Referral (optional)</label>
      <input type="text" id="signupReferral" placeholder="Enter code">
    </div>

    <div class="checkbox-group">
      <input type="checkbox" id="termsCheckbox">
      <label for="termsCheckbox">I agree to the Terms and Privacy Policy</label>
    </div>

    <button class="continue-btn" id="continueSignupBtn">Continue</button>

    <div class="bottom-text">
      Already have an account? <a id="goToSigninLink">Sign in</a> ¬∑ <a id="goToForgotLink">Forgot password?</a>
    </div>
  </div>

  <!-- SIGN IN view -->
  <div id="signinView" class="auth-panel hidden">
    <div class="back-link" id="backToSignupFromSignin">‚Üê Back</div>
    <h1>Sign in</h1>
    <p class="subtitle">Welcome back to Bitc network</p>

    <div class="form-group">
      <label>Email</label>
      <input type="email" id="signinEmail" placeholder=" " autocomplete="email">
    </div>

    <div class="form-group password-wrapper">
      <label>Password</label>
      <input type="password" id="signinPassword" autocomplete="current-password">
      <svg class="eye-icon" onclick="togglePassword('signinPassword')" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0zm7.5 0S18 5 12 5 4.5 12 4.5 12 6 19 12 19s7.5-7 7.5-7z"/>
      </svg>
      <div class="error-message" id="signinError"></div>
    </div>

    <div class="forgot-note">
      <a id="goToForgotFromSignin">Forgot password?</a>
    </div>

    <button class="continue-btn" id="signinBtn">Sign in</button>

    <hr>
    <div class="bottom-text" style="margin-top:0">
      No account? <a id="goToSignupFromSignin">Create one</a>
    </div>
  </div>

  <!-- FORGOT PASSWORD view -->
  <div id="forgotView" class="auth-panel hidden">
    <div class="back-link" id="backToSigninFromForgot">‚Üê Back to sign in</div>
    <h1>Reset your password</h1>
    <p class="subtitle">We'll send a reset link to your email</p>

    <div class="forgot-instruction" id="forgotInstruction">
      <strong>üîí No worries</strong> ‚Äî enter the email address you use for Bitc network, and we'll email you a link to create a new password.
    </div>

    <div class="form-group" style="margin-bottom: 4px;">
      <label>Email</label>
      <input type="email" id="forgotEmail" placeholder=" " autocomplete="email">
      <div class="error-message" id="forgotError"></div>
    </div>
    <div class="field-hint">We'll only send if there's an active account</div>

    <button class="continue-btn" id="sendResetBtn" style="margin-top: 24px;">Send reset link</button>

    <div id="resetSuccessMsg" class="reset-message hidden">
      <div class="check-icon">‚úì</div>
      <p><strong>Reset link sent</strong></p>
      <p>If an account exists for <span id="submittedEmailDisplay" class="email-placeholder"></span>, you'll get a reset link shortly.</p>
      <div class="small-note">
        Didn't arrive? Check your spam folder or <a href="#" id="resendLink" style="color:#7b2eda;">try again</a>.
      </div>
    </div>

    <div class="action-links">
      <a id="goToSignupFromForgot">Create account</a>
      <a id="goToSigninFromForgotAlt">Sign in instead</a>
    </div>
  </div>

  <!-- VERIFY EMAIL view (new) -->
  <div id="verifyView" class="auth-panel hidden">
    <div class="back-link" id="backToSigninFromVerify">‚Üê Back to sign in</div>
    <div style="text-align: center; margin: 20px 0;">
      <div style="font-size: 64px; color: #7b2eda;">‚úâÔ∏è</div>
    </div>
    <h1>Verify your email</h1>
    <p style="color: #4b5563; text-align: center; margin-bottom: 20px;" id="verifyMessage">Verification sent to your inbox</p>
    
    <div class="forgot-instruction">
      <strong>üìß Please check your email</strong> ‚Äî click the verification link. If not received, check spam.
    </div>
    
    <button class="continue-btn" id="resendVerifyBtn" style="margin-bottom: 12px;">
      Resend email
    </button>
    <button class="social-btn" id="verifyLoginBtn" style="justify-content: center;">
      Continue to sign in
    </button>
  </div>
</div>

<!-- Firebase SDK -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
  import { 
    getAuth, 
    signInWithEmailAndPassword, 
    createUserWithEmailAndPassword, 
    sendPasswordResetEmail, 
    sendEmailVerification,
    signInWithPopup,
    GoogleAuthProvider
  } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
  import { 
    getFirestore, 
    doc, 
    setDoc, 
    getDoc 
  } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBEjeRSyKbpEmbNk0SYLUFPp3lbgP9x3Ow",
    authDomain: "volcanobxpl.firebaseapp.com",
    projectId: "volcanobxpl",
    storageBucket: "volcanobxpl.firebasestorage.app",
    messagingSenderId: "742861205377",
    appId: "1:742861205377:web:bbe8a42b78c90354a64280",
    measurementId: "G-G1KWGHLZES"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);
  const googleProvider = new GoogleAuthProvider();

  // Make Firebase available globally
  window.firebaseAuth = auth;
  window.firebaseDb = db;
  window.firebase = {
    signInWithEmailAndPassword,
    createUserWithEmailAndPassword,
    sendPasswordResetEmail,
    sendEmailVerification,
    signInWithPopup,
    setDoc,
    doc,
    getDoc,
    googleProvider
  };
</script>

<script>
  // ---------- GLOBAL VARIABLES ----------
  let currentUser = null;

  // View elements
  const signupView = document.getElementById('signupView');
  const signinView = document.getElementById('signinView');
  const forgotView = document.getElementById('forgotView');
  const verifyView = document.getElementById('verifyView');

  // ---------- TOAST ----------
  function showToast(msg, type = 'success') {
    const toast = document.createElement('div');
    toast.className = `toast ${type}`;
    toast.innerHTML = `<span>${msg}</span>`;
    document.body.appendChild(toast);
    setTimeout(() => { toast.remove(); }, 3000);
  }

  // ---------- TOGGLE PASSWORD ----------
  window.togglePassword = function(fieldId) {
    const field = document.getElementById(fieldId);
    if (field) {
      field.type = field.type === 'password' ? 'text' : 'password';
    }
  };

  // ---------- VIEW NAVIGATION ----------
  function showView(viewName) {
    signupView.classList.add('hidden');
    signinView.classList.add('hidden');
    forgotView.classList.add('hidden');
    verifyView.classList.add('hidden');
    
    if (viewName === 'signup') signupView.classList.remove('hidden');
    if (viewName === 'signin') signinView.classList.remove('hidden');
    if (viewName === 'forgot') {
      forgotView.classList.remove('hidden');
      document.getElementById('forgotInstruction').classList.remove('hidden');
      document.getElementById('resetSuccessMsg').classList.add('hidden');
      document.getElementById('forgotEmail').value = '';
      document.getElementById('forgotError').classList.remove('visible');
    }
    if (viewName === 'verify') verifyView.classList.remove('hidden');
  }

  // ---------- CREATE USER PROFILE ----------
  async function createUserProfile(user, referral = null) {
    try {
      const profile = {
        email: user.email,
        createdAt: new Date().toISOString(),
        emailVerified: user.emailVerified,
        miningData: {
          referralCode: user.uid.substring(0, 8).toUpperCase(),
          usedReferralCode: referral || null,
          createdAt: new Date().toISOString()
        }
      };
      await window.firebase.setDoc(window.firebase.doc(window.firebaseDb, "users", user.uid), profile);
    } catch (e) { 
      console.warn('Profile creation skipped'); 
    }
  }

  // ---------- AUTH HANDLERS ----------
  async function handleEmailSignup() {
    const email = document.getElementById('signupEmail').value.trim();
    const pwd = document.getElementById('signupPassword').value;
    const confirm = document.getElementById('signupConfirmPassword').value;
    const referral = document.getElementById('signupReferral').value.trim();
    const terms = document.getElementById('termsCheckbox').checked;

    // Clear previous errors
    document.getElementById('signupEmailError').classList.remove('visible');
    document.getElementById('signupPasswordError').classList.remove('visible');
    document.getElementById('signupConfirmError').classList.remove('visible');

    if (!terms) {
      showToast('Please agree to Terms & Privacy', 'error');
      return;
    }

    if (!email || !pwd || !confirm) {
      showToast('Please fill in all fields', 'error');
      return;
    }

    if (pwd !== confirm) {
      document.getElementById('signupConfirmError').textContent = 'Passwords do not match';
      document.getElementById('signupConfirmError').classList.add('visible');
      return;
    }

    if (pwd.length < 6) {
      document.getElementById('signupPasswordError').textContent = 'Password must be at least 6 characters';
      document.getElementById('signupPasswordError').classList.add('visible');
      return;
    }

    const btn = document.getElementById('continueSignupBtn');
    btn.innerHTML = '<div class="loading"></div> Creating...';
    btn.disabled = true;

    try {
      const cred = await window.firebase.createUserWithEmailAndPassword(window.firebaseAuth, email, pwd);
      const user = cred.user;
      await window.firebase.sendEmailVerification(user);
      await createUserProfile(user, referral);
      
      currentUser = user;
      document.getElementById('verifyMessage').textContent = `Verification sent to ${user.email}`;
      showView('verify');
      showToast('Account created! Check your email.', 'success');
    } catch (err) {
      let msg = 'Signup failed';
      if (err.code === 'auth/email-already-in-use') msg = 'Email already in use';
      else if (err.code === 'auth/weak-password') msg = 'Password too weak';
      else if (err.code === 'auth/invalid-email') msg = 'Invalid email';
      showToast(msg, 'error');
    } finally {
      btn.innerHTML = 'Continue';
      btn.disabled = false;
    }
  }

  async function handleEmailLogin() {
    const email = document.getElementById('signinEmail').value.trim();
    const pwd = document.getElementById('signinPassword').value;
    const errEl = document.getElementById('signinError');
    const btn = document.getElementById('signinBtn');

    errEl.classList.remove('visible');

    if (!email || !pwd) {
      showToast('Please fill in all fields', 'error');
      return;
    }

    btn.innerHTML = '<div class="loading"></div> Signing in...';
    btn.disabled = true;

    try {
      const cred = await window.firebase.signInWithEmailAndPassword(window.firebaseAuth, email, pwd);
      const user = cred.user;
      
      if (!user.emailVerified) {
        currentUser = user;
        document.getElementById('verifyMessage').textContent = `Verification sent to ${user.email}`;
        showView('verify');
        showToast('Please verify your email', 'error');
        return;
      }
      
      showToast('Login successful! Redirecting...', 'success');
      setTimeout(() => {
        window.location.href = 'dashboard.html'; // Redirect to dashboard
      }, 1500);
    } catch (err) {
      let msg = 'Login failed';
      if (err.code === 'auth/user-not-found') msg = 'No account found';
      else if (err.code === 'auth/wrong-password') msg = 'Incorrect password';
      else if (err.code === 'auth/invalid-email') msg = 'Invalid email';
      errEl.textContent = msg;
      errEl.classList.add('visible');
      showToast(msg, 'error');
    } finally {
      btn.innerHTML = 'Sign in';
      btn.disabled = false;
    }
  }

  async function handleGoogleSignIn() {
    const btn = document.getElementById('googleBtn');
    const originalText = btn.innerHTML;
    btn.innerHTML = '<div class="loading"></div> Connecting...';
    btn.disabled = true;

    try {
      const result = await window.firebase.signInWithPopup(window.firebaseAuth, window.firebase.googleProvider);
      const user = result.user;
      
      // Check if user profile exists
      const userDoc = await window.firebase.getDoc(window.firebase.doc(window.firebaseDb, "users", user.uid));
      if (!userDoc.exists()) {
        await createUserProfile(user);
      }
      
      showToast('Google sign-in successful!', 'success');
      setTimeout(() => {
        window.location.href = 'dashboard.html';
      }, 1500);
    } catch (err) {
      showToast('Google sign-in failed: ' + err.message, 'error');
      btn.innerHTML = originalText;
      btn.disabled = false;
    }
  }

  async function handleForgotPassword() {
    const email = document.getElementById('forgotEmail').value.trim();
    const errEl = document.getElementById('forgotError');
    
    errEl.classList.remove('visible');

    if (!email) {
      showToast('Enter your email', 'error');
      return;
    }

    if (!email.includes('@') || !email.includes('.')) {
      errEl.textContent = 'Enter a valid email';
      errEl.classList.add('visible');
      return;
    }

    const btn = document.getElementById('sendResetBtn');
    btn.innerHTML = '<div class="loading"></div> Sending...';
    btn.disabled = true;

    try {
      await window.firebase.sendPasswordResetEmail(window.firebaseAuth, email);
      
      document.getElementById('submittedEmailDisplay').textContent = email;
      document.getElementById('forgotInstruction').classList.add('hidden');
      document.getElementById('resetSuccessMsg').classList.remove('hidden');
      document.getElementById('forgotEmail').value = '';
      
      showToast('Reset link sent!', 'success');
    } catch (err) {
      let msg = 'Failed to send';
      if (err.code === 'auth/user-not-found') msg = 'Email not found';
      showToast(msg, 'error');
    } finally {
      btn.innerHTML = 'Send reset link';
      btn.disabled = false;
    }
  }

  async function resendVerification() {
    if (!currentUser) {
      showToast('Please sign in first', 'error');
      showView('signin');
      return;
    }

    const btn = document.getElementById('resendVerifyBtn');
    btn.innerHTML = '<div class="loading"></div> Sending...';
    btn.disabled = true;

    try {
      await window.firebase.sendEmailVerification(currentUser);
      showToast('Verification email resent!', 'success');
    } catch (err) {
      showToast('Failed to resend: ' + err.message, 'error');
    } finally {
      btn.innerHTML = 'Resend email';
      btn.disabled = false;
    }
  }

  // ---------- EVENT LISTENERS ----------
  document.addEventListener('DOMContentLoaded', () => {
    // Signup navigation
    document.getElementById('goToSigninLink').addEventListener('click', (e) => { 
      e.preventDefault(); 
      showView('signin'); 
    });
    document.getElementById('goToForgotLink').addEventListener('click', (e) => { 
      e.preventDefault(); 
      showView('forgot'); 
    });
    
    // Signin navigation
    document.getElementById('goToSignupFromSignin').addEventListener('click', (e) => { 
      e.preventDefault(); 
      showView('signup'); 
    });
    document.getElementById('goToForgotFromSignin').addEventListener('click', (e) => { 
      e.preventDefault(); 
      showView('forgot'); 
    });
    document.getElementById('backToSignupFromSignin').addEventListener('click', () => showView('signup'));
    
    // Forgot navigation
    document.getElementById('goToSignupFromForgot').addEventListener('click', (e) => { 
      e.preventDefault(); 
      showView('signup'); 
    });
    document.getElementById('goToSigninFromForgotAlt').addEventListener('click', (e) => { 
      e.preventDefault(); 
      showView('signin'); 
    });
    document.getElementById('backToSigninFromForgot').addEventListener('click', () => showView('signin'));
    
    // Verify navigation
    document.getElementById('backToSigninFromVerify').addEventListener('click', () => showView('signin'));
    document.getElementById('verifyLoginBtn').addEventListener('click', () => showView('signin'));

    // Auth buttons
    document.getElementById('continueSignupBtn').addEventListener('click', handleEmailSignup);
    document.getElementById('signinBtn').addEventListener('click', handleEmailLogin);
    document.getElementById('googleBtn').addEventListener('click', handleGoogleSignIn);
    document.getElementById('sendResetBtn').addEventListener('click', handleForgotPassword);
    document.getElementById('resendVerifyBtn').addEventListener('click', resendVerification);
    
    // Resend link in success message
    document.getElementById('resendLink').addEventListener('click', (e) => {
      e.preventDefault();
      const email = document.getElementById('submittedEmailDisplay').textContent;
      if (email) {
        document.getElementById('forgotEmail').value = email;
        handleForgotPassword();
      }
    });

    // Prevent form submission on enter
    document.querySelectorAll('input').forEach(input => {
      input.addEventListener('keypress', (e) => { 
        if (e.key === 'Enter') e.preventDefault(); 
      });
    });

    // Start with signup view
    showView('signup');
  });
</script>
</body>
</html>
